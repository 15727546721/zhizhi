# 项目结构说明

## 1. 整体目录结构

```
zhizhi-backend/
├── docs/                          # 文档目录
│   ├── architecture/              # 架构文档
│   │   └── ddd/                  # DDD相关文档
│   └── dev-ops/                  # 运维文档
├── src/                           # 源代码目录
│   ├── main/                     # 主代码
│   │   ├── java/                 # Java源代码
│   │   │   └── cn.xu/           # 项目根包
│   │   │       ├── application/ # 应用层
│   │   │       ├── domain/      # 领域层
│   │   │       └── infrastructure/ # 基础设施层
│   │   └── resources/           # 资源文件
│   └── test/                    # 测试代码
└── target/                      # 编译输出目录
```

## 2. 应用层结构 (application)

```
application/
├── common/                      # 通用应用服务
├── post/                       # 帖子应用服务
├── comment/                    # 评论应用服务
├── user/                       # 用户应用服务
└── ...                         # 其他应用服务
```

## 3. 领域层结构 (domain)

```
domain/
├── post/                       # 帖子领域
│   ├── model/                 # 领域模型
│   │   ├── aggregate/        # 聚合根
│   │   ├── entity/           # 实体
│   │   ├── valobj/           # 值对象
│   │   └── policy/           # 策略/规约
│   ├── repository/           # 仓储接口
│   ├── service/              # 领域服务
│   └── event/                # 领域事件
├── comment/                    # 评论领域
├── user/                       # 用户领域
├── file/                       # 文件领域
├── follow/                     # 关注领域
├── like/                       # 点赞领域
├── message/                    # 消息领域
├── notification/               # 通知领域
├── permission/                 # 权限领域
├── report/                     # 举报领域
└── essay/                      # 随笔领域
```

## 4. 基础设施层结构 (infrastructure)

```
infrastructure/
├── common/                     # 通用基础设施
├── config/                     # 配置类
├── constant/                   # 常量定义
├── persistent/                 # 持久化相关
│   ├── po/                    # 持久化对象
│   ├── dao/                   # 数据访问对象
│   ├── repository/            # 仓储实现
│   ├── converter/             # 对象转换器
│   └── mapper/                # MyBatis映射文件
├── cache/                      # 缓存相关
└── client/                     # 外部服务客户端
```

## 5. 领域层详细说明

### 5.1 聚合根 (Aggregate Root)
- 每个领域包含一个或多个聚合根
- 聚合根负责维护聚合内的一致性
- 聚合根是外部访问聚合的唯一入口

### 5.2 实体 (Entity)
- 具有唯一标识的对象
- 通过标识判断相等性
- 包含业务行为和业务规则

### 5.3 值对象 (Value Object)
- 描述领域中某个方面的对象
- 通过属性判断相等性
- 不可变性

### 5.4 仓储接口 (Repository Interface)
- 定义在领域层
- 提供领域对象的持久化操作抽象
- 遵循依赖倒置原则

### 5.5 领域服务 (Domain Service)
- 处理跨实体或跨聚合的业务逻辑
- 实现领域中的复杂业务规则
- 通常无状态

## 6. 基础设施层详细说明

### 6.1 仓储实现 (Repository Implementation)
- 实现在基础设施层
- 实现领域层定义的仓储接口
- 负责具体的持久化操作

### 6.2 对象转换器 (Converter)
- 负责领域对象与持久化对象之间的转换
- 保持领域层与基础设施层的隔离
- 遵循防腐层模式

### 6.3 数据访问对象 (DAO)
- 负责与数据库的直接交互
- 提供基本的CRUD操作
- 不包含业务逻辑

## 7. 分层依赖关系

```
application -> domain -> infrastructure
     ↓           ↓             ↑
   (依赖)      (依赖)        (实现)
```

- 应用层依赖领域层的接口和领域服务
- 领域层不依赖基础设施层的具体实现
- 基础设施层实现领域层定义的接口

## 8. 包命名规范

- 所有包名使用小写字母
- 包名应具有明确的业务含义
- 避免过深的包层级结构