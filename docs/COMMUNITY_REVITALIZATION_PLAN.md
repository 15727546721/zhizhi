# 知之(Zhizhi)社区活跃度提升与业务重构执行方案

**版本**: v1.0
**日期**: 2025-11-19
**目标**: 明确产品定位，重构内容组织逻辑，提升社区活跃度

---

## 1. 战略定位：高价值知识问答/分享社区

**核心对标**: 知乎 (Zhihu) / 掘金 (Juejin) / StackOverflow
**核心价值**: "让对的内容，最快地找到对的人"
**第一关键指标 (North Star Metric)**: **话题活跃度** (Topic Activity) —— 包括话题下的发帖量、讨论量和关注人数。

---

## 2. 核心架构：漏斗式内容组织模型

为了解决"内容找不到人，人找不到内容"的问题，实施以下三层内容架构：

### 2.1 第一层：行政区划 —— 分类 (Category)
*   **定位**: 整个社区的顶层架构，固定且少量。
*   **作用**: 
    *   粗粒度流量分发（如：后端、前端、AI、职场）。
    *   后台管理和数据统计的维度。
*   **规则**: 
    *   用户**不可创建**，仅由管理员维护。
    *   每个 **话题 (Topic)** 必须属于一个 **分类 (Category)**。

### 2.2 第二层：兴趣圈子 —— 话题 (Topic) 【核心】
*   **定位**: 社区的"发动机"，动态且活跃。
*   **作用**: 
    *   聚合兴趣相同的人。
    *   首页推荐流的核心依据。
*   **规则**: 
    *   用户可申请创建，或由管理员预设。
    *   用户**关注话题**，而非关注分类。
    *   **强制关联**: 帖子 (Post) 必须至少关联 1 个话题。

### 2.3 第三层：检索索引 —— 标签 (Tag)
*   **定位**: 辅助检索工具，海量且长尾。
*   **作用**: SEO 优化，具体问题定位（如具体的报错信息）。
*   **规则**: 
    *   用户自由输入。
    *   不作为流量分发的依据，仅用于搜索。

---

## 3. 数据库与领域模型调整

### 3.1 模型关系变更
目前 `topic` 表缺少与 `category` 的关联。需要建立强关联。

**变更计划**:
1.  `topic` 表新增 `category_id` 字段。
2.  `post` 表保持与 `topic` 的多对多关系 (`post_topic` 表)。
3.  `user` 表保持与 `topic` 的多对多关系 (关注关系)。

```sql
-- 建议的 SQL 变更
ALTER TABLE `topic` ADD COLUMN `category_id` BIGINT NOT NULL COMMENT '所属分类ID' AFTER `id`;
CREATE INDEX `idx_category_id` ON `topic` (`category_id`);
```

### 3.2 推荐算法逻辑
首页推荐流 (Home Feed) 逻辑重构：

*   **旧逻辑**: `SELECT * FROM post ORDER BY create_time DESC` (简单时间流)
*   **新逻辑**: 
    1.  获取用户关注的话题列表: `User -> Follow -> TopicList`
    2.  获取这些话题下的最新/热门帖子: `TopicList -> PostTopic -> PostList`
    3.  (冷启动) 如果用户无关注话题，则推荐 `Category` 下的热门话题的内容。

---

## 4. 执行路线图 (Roadmap)

### 阶段一：骨架重塑 (Backend & DB)
- [ ] **数据库迁移**: 给 `topic` 表添加 `category_id` 字段，并初始化数据（将现有 Topic 归类）。
- [ ] **接口改造**: 
    - `TopicService`: 创建话题时必须指定 `categoryId`。
    - `FeedService`: 新增基于 "用户关注话题" 的聚合查询接口。
- [ ] **数据清洗**: 检查现有孤立的 Post，为其补充 Topic 信息。

### 阶段二：交互重构 (Frontend)
- [ ] **发帖流程升级 (PostCreator)**:
    - 步骤 1: 必须选择 Topic (支持搜索 + 智能推荐)。
    - 步骤 2: 自动根据 Topic 带出 Category (用户无需手动选 Category)。
    - 步骤 3: 选填 Tags。
- [ ] **首页改版 (HomeView)**:
    - 默认 Tab 改为 "关注"，显示关注话题的动态。
    - 新增 "广场/发现" Tab，按 Category 展示热门 Topic。
- [ ] **话题详情页 (TopicDetail)**:
    - 增加 "活跃贡献者" 排行榜。
    - 增加 "加入/关注" 醒目按钮。

### 阶段三：运营机制 (Operations)
- [ ] **话题主机制**: 允许用户申请成为某个 Topic 的管理者（拥有加精、置顶权限）。
- [ ] **冷启动引导**: 新用户注册后，弹出 "选择你感兴趣的话题" 引导页 (Onboarding)。
- [ ] **话题广场**: 建立 `/topics` 页面，展示各 Category 下的活跃 Topic 矩阵。

---

## 5. 关键交互流程设计 (User Journey)

### 场景 A: 用户消费内容
> 用户进站 -> 首页(关注流)看到 "Vue.js" 话题下的新文章 -> 点击文章阅读 -> 觉得不错 -> **点击"Vue.js"话题标签** -> 进入话题页 -> **关注话题** -> 以后首页能看到更多相关内容。

### 场景 B: 用户发布内容
> 用户点击"发帖" -> 输入标题内容 -> **系统提示"请选择话题"** -> 用户搜"Vue" -> 系统展示"Vue.js (前端分类)", "Vue Router (前端分类)" -> 用户选择 "Vue.js" -> 发布 -> **文章自动推送给关注"Vue.js"话题的 5000 人** -> 瞬间获得反馈。

---

## 6. 总结
本方案的核心在于**将流量分发的权利从"全局"下放到"话题"**。
通过**Topic**这个中间层，连接**内容(Post)**和**人(User)**，实现社区的自运转。
